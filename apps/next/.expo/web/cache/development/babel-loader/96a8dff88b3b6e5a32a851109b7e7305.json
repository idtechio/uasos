{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport { serverSideTranslations } from \"next-i18next/serverSideTranslations\";\nimport { useRouter } from \"next/router\";\nimport React, { useContext } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport AppBack from \"../../src/components/AppBack\";\nimport { CompositionAppBody } from \"../../src/components/Compositions\";\nimport DetailsDecisionButtons from \"../../src/components/DetailsDecisionButtons/DetailsDecisionButtons\";\nimport DetailsSection from \"../../src/components/DetailsSection/DetailsSection\";\nimport { Error } from \"../../src/components/Inputs/style\";\nimport PageContentWrapper from \"../../src/components/PageContentWrapper\";\nimport Redirect from \"../../src/components/Redirect\";\nimport { LoadingCards } from \"../../src/components/SupportSection/LoadingCards\";\nimport { GuestHostType } from \"../../src/components/SupportSection/mapper\";\nimport WarningSection from \"../../src/components/WarningSection/WarningSection\";\nimport { useOffersList } from \"../../src/queries/useOffersList\";\nimport { useRequestsList } from \"../../src/queries/useRequestsList\";\nimport { AuthContext } from \"../_app\";\nvar bottomMarginStyle = {\n  marginBottom: 15\n};\nvar DETAIL_TYPE = {\n  offer: \"offer\",\n  request: \"request\"\n};\n\nfunction DetailsContent() {\n  var router = useRouter();\n  var _router$query = router.query,\n      id = _router$query.id,\n      type = _router$query.type;\n\n  var _useTranslation = useTranslation(\"offer-details\"),\n      t = _useTranslation.t;\n\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      dataToShow = _React$useState2[0],\n      setDataToShow = _React$useState2[1];\n\n  var _useOffersList = useOffersList(),\n      offersData = _useOffersList.data,\n      isOffersError = _useOffersList.isError,\n      isOffersLoading = _useOffersList.isLoading;\n\n  var _useRequestsList = useRequestsList(),\n      requestsData = _useRequestsList.data,\n      isRequestsError = _useRequestsList.isError,\n      isRequestsLoading = _useRequestsList.isLoading;\n\n  var offers = offersData ? offersData.offers : undefined;\n  var requests = requestsData ? requestsData.requests : undefined;\n  React.useEffect(function () {\n    if (offers && offers.length && !dataToShow) {\n      var data = offers.filter(function (el) {\n        return el.id === id;\n      })[0];\n\n      if (data) {\n        setDataToShow(data);\n      }\n    }\n  }, [dataToShow, id, offers]);\n  React.useEffect(function () {\n    if (requests && requests.length && !dataToShow) {\n      var data = requests.filter(function (el) {\n        return el.id === id;\n      })[0];\n\n      if (data) {\n        setDataToShow(data);\n      }\n    }\n  }, [dataToShow, id, requests]);\n  return React.createElement(CompositionAppBody, null, React.createElement(PageContentWrapper, null, isOffersLoading || isRequestsLoading ? React.createElement(LoadingCards, {\n    count: 1,\n    showImage: true\n  }) : React.createElement(React.Fragment, null, React.createElement(AppBack, {\n    to: \"/dashboard\"\n  }), isOffersError || isRequestsError ? React.createElement(Error, null, t(\"could_not_load_details\")) : React.createElement(React.Fragment, null, dataToShow != null && dataToShow.match_id && type === DETAIL_TYPE.offer ? React.createElement(WarningSection, null) : null, React.createElement(DetailsSection, {\n    isOffer: type === DETAIL_TYPE.offer,\n    data: dataToShow,\n    containerStyle: bottomMarginStyle\n  }), dataToShow != null && dataToShow.type && [GuestHostType.FOUND_A_MATCH, GuestHostType.BEING_CONFIRMED].includes(dataToShow.type) ? React.createElement(DetailsDecisionButtons, {\n    matchId: dataToShow == null ? void 0 : dataToShow.match_id,\n    typeOfUser: type === DETAIL_TYPE.offer ? \"host\" : \"guest\"\n  }) : null))));\n}\n\nexport default function Details() {\n  var _useContext = useContext(AuthContext),\n      identity = _useContext.identity,\n      loaded = _useContext.loaded;\n\n  if (!loaded) {\n    return React.createElement(CompositionAppBody, null, React.createElement(PageContentWrapper, null, React.createElement(LoadingCards, {\n      count: 1,\n      showImage: false\n    })));\n  }\n\n  if (loaded && !identity) {\n    return React.createElement(Redirect, {\n      path: \"/signin\"\n    });\n  }\n\n  return React.createElement(DetailsContent, null);\n}\nexport var getServerSideProps = function getServerSideProps(_ref) {\n  var locale;\n  return _regeneratorRuntime.async(function getServerSideProps$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          locale = _ref.locale;\n          _context.t0 = _objectSpread;\n          _context.t1 = {};\n          _context.t2 = locale;\n\n          if (!_context.t2) {\n            _context.next = 8;\n            break;\n          }\n\n          _context.next = 7;\n          return _regeneratorRuntime.awrap(serverSideTranslations(locale));\n\n        case 7:\n          _context.t2 = _context.sent;\n\n        case 8:\n          _context.t3 = _context.t2;\n          _context.t4 = (0, _context.t0)(_context.t1, _context.t3);\n          return _context.abrupt(\"return\", {\n            props: _context.t4\n          });\n\n        case 11:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};","map":{"version":3,"sources":["/Users/stanislav.kovalov/Desktop/uasos/apps/next/pages/details/index.tsx"],"names":["serverSideTranslations","useRouter","React","useContext","useTranslation","AppBack","CompositionAppBody","DetailsDecisionButtons","DetailsSection","Error","PageContentWrapper","Redirect","LoadingCards","GuestHostType","WarningSection","useOffersList","useRequestsList","AuthContext","bottomMarginStyle","marginBottom","DETAIL_TYPE","offer","request","DetailsContent","router","query","id","type","t","useState","dataToShow","setDataToShow","offersData","data","isOffersError","isError","isOffersLoading","isLoading","requestsData","isRequestsError","isRequestsLoading","offers","undefined","requests","useEffect","length","filter","el","match_id","FOUND_A_MATCH","BEING_CONFIRMED","includes","Details","identity","loaded","getServerSideProps","locale","props"],"mappings":"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","sourcesContent":["import { GetServerSideProps } from \"next\";\nimport { serverSideTranslations } from \"next-i18next/serverSideTranslations\";\nimport { useRouter } from \"next/router\";\nimport React, { useContext } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { StyleProp, ViewStyle } from \"react-native\";\nimport AppBack from \"../../src/components/AppBack\";\nimport { CompositionAppBody } from \"../../src/components/Compositions\";\nimport DetailsDecisionButtons from \"../../src/components/DetailsDecisionButtons/DetailsDecisionButtons\";\nimport DetailsSection from \"../../src/components/DetailsSection/DetailsSection\";\nimport { Error } from \"../../src/components/Inputs/style\";\nimport PageContentWrapper from \"../../src/components/PageContentWrapper\";\nimport Redirect from \"../../src/components/Redirect\";\nimport { LoadingCards } from \"../../src/components/SupportSection/LoadingCards\";\nimport { GuestHostType } from \"../../src/components/SupportSection/mapper\";\nimport WarningSection from \"../../src/components/WarningSection/WarningSection\";\nimport { useOffersList } from \"../../src/queries/useOffersList\";\nimport { useRequestsList } from \"../../src/queries/useRequestsList\";\nimport { OfferProps } from \"../api/listing/offers\";\nimport { RequestProps } from \"../api/listing/requests\";\nimport { AuthContext } from \"../_app\";\n\nconst bottomMarginStyle: StyleProp<ViewStyle> = { marginBottom: 15 };\nconst DETAIL_TYPE = {\n  offer: \"offer\",\n  request: \"request\",\n};\n\nfunction DetailsContent() {\n  const router = useRouter();\n  const { id, type } = router.query;\n  const { t } = useTranslation(\"offer-details\");\n  const [dataToShow, setDataToShow] = React.useState<\n    OfferProps | RequestProps | null\n  >(null);\n  const {\n    data: offersData,\n    isError: isOffersError,\n    isLoading: isOffersLoading,\n  } = useOffersList();\n\n  const {\n    data: requestsData,\n    isError: isRequestsError,\n    isLoading: isRequestsLoading,\n  } = useRequestsList();\n\n  const offers = offersData ? offersData.offers : undefined;\n  const requests = requestsData ? requestsData.requests : undefined;\n\n  React.useEffect(() => {\n    if (offers && offers.length && !dataToShow) {\n      const data = offers.filter((el) => el.id === id)[0];\n      if (data) {\n        setDataToShow(data);\n      }\n    }\n  }, [dataToShow, id, offers]);\n\n  React.useEffect(() => {\n    if (requests && requests.length && !dataToShow) {\n      const data = requests.filter((el) => el.id === id)[0];\n      if (data) {\n        setDataToShow(data);\n      }\n    }\n  }, [dataToShow, id, requests]);\n\n  return (\n    <CompositionAppBody>\n      <PageContentWrapper>\n        {isOffersLoading || isRequestsLoading ? (\n          <LoadingCards count={1} showImage={true} />\n        ) : (\n          <>\n            <AppBack to=\"/dashboard\" />\n\n            {isOffersError || isRequestsError ? (\n              <Error>{t(\"could_not_load_details\")}</Error>\n            ) : (\n              <>\n                {dataToShow?.match_id && type === DETAIL_TYPE.offer ? (\n                  <WarningSection />\n                ) : null}\n                <DetailsSection\n                  isOffer={type === DETAIL_TYPE.offer}\n                  data={dataToShow}\n                  containerStyle={bottomMarginStyle}\n                />\n                {dataToShow?.type &&\n                [\n                  GuestHostType.FOUND_A_MATCH,\n                  GuestHostType.BEING_CONFIRMED,\n                ].includes(dataToShow.type) ? (\n                  <DetailsDecisionButtons\n                    matchId={dataToShow?.match_id}\n                    typeOfUser={type === DETAIL_TYPE.offer ? \"host\" : \"guest\"}\n                  />\n                ) : null}\n              </>\n            )}\n          </>\n        )}\n      </PageContentWrapper>\n    </CompositionAppBody>\n  );\n}\n\nexport default function Details() {\n  const { identity, loaded } = useContext(AuthContext);\n\n  if (!loaded) {\n    return (\n      <CompositionAppBody>\n        <PageContentWrapper>\n          <LoadingCards count={1} showImage={false} />\n        </PageContentWrapper>\n      </CompositionAppBody>\n    );\n  }\n\n  if (loaded && !identity) {\n    return <Redirect path=\"/signin\"></Redirect>;\n  }\n\n  return <DetailsContent />;\n}\n\nexport const getServerSideProps: GetServerSideProps = async ({ locale }) => ({\n  props: {\n    ...(locale && (await serverSideTranslations(locale))),\n  },\n});\n"]},"metadata":{},"sourceType":"module"}