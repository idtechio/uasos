{"version":3,"file":"index.esm.js","sources":["../src/useLatest.ts","../src/debounce.ts","../src/usePlacesAutocomplete.ts","../src/utils.ts"],"sourcesContent":["import { RefObject, useRef } from \"react\";\n\nexport default <T>(val: T): RefObject<T> => {\n  const ref = useRef(val);\n  ref.current = val;\n  return ref;\n};\n","export default <F extends (...args: any[]) => void>(\n  fn: F,\n  delay: number\n): ((this: ThisParameterType<F>, ...args: Parameters<F>) => void) => {\n  let timer: ReturnType<typeof setTimeout> | null;\n\n  // eslint-disable-next-line func-names\n  return function (this: ThisParameterType<F>, ...args: Parameters<F>) {\n    if (timer !== null) {\n      clearTimeout(timer);\n      timer = null;\n    }\n\n    timer = setTimeout(() => fn.apply(this, args), delay);\n  };\n};\n","import { useState, useRef, useCallback, useEffect } from \"react\";\n\nimport useLatest from \"./useLatest\";\nimport _debounce from \"./debounce\";\n\nexport interface HookArgs {\n  requestOptions?: Omit<google.maps.places.AutocompletionRequest, \"input\">;\n  debounce?: number;\n  cache?: number | false;\n  cacheKey?: string;\n  googleMaps?: any;\n  callbackName?: string;\n  defaultValue?: string;\n  initOnMount?: boolean;\n}\n\ntype Suggestion = google.maps.places.AutocompletePrediction;\n\ntype Status = `${google.maps.places.PlacesServiceStatus}` | \"\";\n\ninterface Suggestions {\n  readonly loading: boolean;\n  readonly status: Status;\n  data: Suggestion[];\n}\n\ninterface SetValue {\n  (val: string, shouldFetchData?: boolean): void;\n}\n\ninterface HookReturn {\n  ready: boolean;\n  value: string;\n  suggestions: Suggestions;\n  setValue: SetValue;\n  clearSuggestions: () => void;\n  clearCache: (key?: string) => void;\n  init: () => void;\n}\n\nexport const loadApiErr =\n  \"ðŸ’¡ use-places-autocomplete: Google Maps Places API library must be loaded. See: https://github.com/wellyshen/use-places-autocomplete#load-the-library\";\n\nconst usePlacesAutocomplete = ({\n  requestOptions,\n  debounce = 200,\n  cache = 24 * 60 * 60,\n  cacheKey = \"upa\",\n  googleMaps,\n  callbackName,\n  defaultValue = \"\",\n  initOnMount = true,\n}: HookArgs = {}): HookReturn => {\n  const [ready, setReady] = useState(false);\n  const [value, setVal] = useState(defaultValue);\n  const [suggestions, setSuggestions] = useState<Suggestions>({\n    loading: false,\n    status: \"\",\n    data: [],\n  });\n  const asRef = useRef<google.maps.places.AutocompleteService>();\n  const requestOptionsRef = useLatest(requestOptions);\n  const googleMapsRef = useLatest(googleMaps);\n\n  const init = useCallback(() => {\n    if (asRef.current) return;\n\n    const { google } = window;\n    const { current: gMaps } = googleMapsRef;\n    const placesLib = gMaps?.places || google?.maps?.places;\n\n    if (!placesLib) {\n      console.error(loadApiErr);\n      return;\n    }\n\n    asRef.current = new placesLib.AutocompleteService();\n    setReady(true);\n  }, [googleMapsRef]);\n\n  const clearSuggestions = useCallback(() => {\n    setSuggestions({ loading: false, status: \"\", data: [] });\n  }, []);\n\n  const clearCache = useCallback(\n    (key = cacheKey) => {\n      try {\n        sessionStorage.removeItem(key);\n      } catch (error) {\n        // Skip exception\n      }\n    },\n    [cacheKey]\n  );\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const fetchPredictions = useCallback(\n    _debounce((val: string) => {\n      if (!val) {\n        clearSuggestions();\n        return;\n      }\n\n      setSuggestions((prevState) => ({ ...prevState, loading: true }));\n\n      let cachedData: Record<string, { data: Suggestion[]; maxAge: number }> =\n        {};\n\n      try {\n        cachedData = JSON.parse(sessionStorage.getItem(cacheKey) || \"{}\");\n      } catch (error) {\n        // Skip exception\n      }\n\n      if (cache) {\n        cachedData = Object.keys(cachedData).reduce(\n          (acc: typeof cachedData, key) => {\n            if (cachedData[key].maxAge - Date.now() >= 0)\n              acc[key] = cachedData[key];\n            return acc;\n          },\n          {}\n        );\n\n        if (cachedData[val]) {\n          setSuggestions({\n            loading: false,\n            status: \"OK\",\n            data: cachedData[val].data,\n          });\n          return;\n        }\n      }\n\n      asRef.current?.getPlacePredictions(\n        { ...requestOptionsRef.current, input: val },\n        (data: Suggestion[] | null, status: Status) => {\n          setSuggestions({ loading: false, status, data: data || [] });\n\n          if (cache && status === \"OK\") {\n            cachedData[val] = {\n              data: data as Suggestion[],\n              maxAge: Date.now() + cache * 1000,\n            };\n\n            try {\n              sessionStorage.setItem(cacheKey, JSON.stringify(cachedData));\n            } catch (error) {\n              // Skip exception\n            }\n          }\n        }\n      );\n    }, debounce),\n    [cache, cacheKey, clearSuggestions, requestOptionsRef]\n  );\n\n  const setValue: SetValue = useCallback(\n    (val, shouldFetchData = true) => {\n      setVal(val);\n      if (asRef.current && shouldFetchData) fetchPredictions(val);\n    },\n    [fetchPredictions]\n  );\n\n  useEffect(() => {\n    if (!initOnMount) return () => null;\n\n    const { google } = window;\n\n    if (!googleMapsRef.current && !google?.maps && callbackName) {\n      (window as any)[callbackName] = init;\n    } else {\n      init();\n    }\n\n    return () => {\n      // @ts-ignore\n      if ((window as any)[callbackName]) delete (window as any)[callbackName];\n    };\n  }, [callbackName, googleMapsRef, init, initOnMount]);\n\n  return {\n    ready,\n    value,\n    suggestions,\n    setValue,\n    clearSuggestions,\n    clearCache,\n    init,\n  };\n};\n\nexport default usePlacesAutocomplete;\n","/* eslint-disable compat/compat */\n\ntype GeoArgs = google.maps.GeocoderRequest;\n\ntype GeocodeResult = google.maps.GeocoderResult;\n\ntype GeoReturn = Promise<GeocodeResult[]>;\n\nexport const geocodeErr =\n  \"ðŸ’¡ use-places-autocomplete: Please provide an address when using getGeocode() with the componentRestrictions.\";\n\nexport const getGeocode = (args: GeoArgs): GeoReturn => {\n  const geocoder = new window.google.maps.Geocoder();\n\n  return new Promise((resolve, reject) => {\n    geocoder.geocode(args, (results, status) => {\n      if (status !== \"OK\") reject(status);\n      if (!args.address && args.componentRestrictions) {\n        console.error(geocodeErr);\n        resolve(results);\n      }\n      resolve(results);\n    });\n  });\n};\n\ntype LatLng = { lat: number; lng: number };\n\nexport const getLatLng = (result: GeocodeResult): LatLng => {\n  const { lat, lng } = result.geometry.location;\n  return { lat: lat(), lng: lng() };\n};\n\ntype ZipCode = string | undefined;\n\nexport const getZipCode = (\n  result: GeocodeResult,\n  useShortName: false\n): ZipCode => {\n  const foundZip = result.address_components.find(({ types }) =>\n    types.includes(\"postal_code\")\n  );\n\n  if (!foundZip) return undefined;\n\n  return useShortName ? foundZip.short_name : foundZip.long_name;\n};\n\ntype GetDetailsArgs = google.maps.places.PlaceDetailsRequest;\n\ntype DetailsResult = Promise<google.maps.places.PlaceResult | string>;\n\nexport const getDetailsErr =\n  \"ðŸ’¡ use-places-autocomplete: Please provide a place Id when using getDetails() either as a string or as part of an Autocomplete Prediction.\";\n\nexport const getDetails = (args: GetDetailsArgs): DetailsResult => {\n  const PlacesService = new window.google.maps.places.PlacesService(\n    document.createElement(\"div\")\n  );\n\n  if (!args.placeId) {\n    console.error(getDetailsErr);\n    return Promise.reject(getDetailsErr);\n  }\n\n  return new Promise((resolve, reject) => {\n    PlacesService.getDetails(args, (results, status) => {\n      if (status !== \"OK\") reject(status);\n      resolve(results);\n    });\n  });\n};\n"],"names":["val","ref","useRef","current","fn","delay","timer","args","clearTimeout","setTimeout","apply","loadApiErr","usePlacesAutocomplete","requestOptions","debounce","cache","cacheKey","googleMaps","callbackName","defaultValue","initOnMount","useState","ready","setReady","value","setVal","loading","status","data","suggestions","setSuggestions","asRef","requestOptionsRef","useLatest","googleMapsRef","init","useCallback","window","google","gMaps","placesLib","places","maps","console","error","AutocompleteService","clearSuggestions","clearCache","key","sessionStorage","removeItem","fetchPredictions","_debounce","prevState","cachedData","JSON","parse","getItem","Object","keys","reduce","acc","maxAge","Date","now","getPlacePredictions","input","setItem","stringify","setValue","shouldFetchData","useEffect","geocodeErr","getGeocode","geocoder","Geocoder","Promise","resolve","reject","geocode","results","address","componentRestrictions","getLatLng","result","geometry","location","lat","lng","getZipCode","useShortName","foundZip","address_components","find","types","includes","undefined","short_name","long_name","getDetailsErr","getDetails","PlacesService","document","createElement","placeId"],"mappings":"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"}