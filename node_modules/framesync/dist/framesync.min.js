!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).framesync={})}(this,(function(e){"use strict";var n=1/60*1e3,t="undefined"!=typeof performance?function(){return performance.now()}:function(){return Date.now()},r="undefined"!=typeof window?function(e){return window.requestAnimationFrame(e)}:function(e){return setTimeout((function(){return e(t())}),n)};var u=!0,o=!1,i=!1,f={delta:0,timestamp:0},c=["read","update","preRender","render","postRender"],a=c.reduce((function(e,n){return e[n]=function(e){var n=[],t=[],r=0,u=!1,o=new WeakSet,i={schedule:function(e,i,f){void 0===i&&(i=!1),void 0===f&&(f=!1);var c=f&&u,a=c?n:t;return i&&o.add(e),-1===a.indexOf(e)&&(a.push(e),c&&u&&(r=n.length)),e},cancel:function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1),o.delete(e)},process:function(f){var c;if(u=!0,n=(c=[t,n])[0],(t=c[1]).length=0,r=n.length)for(var a=0;a<r;a++){var d=n[a];d(f),o.has(d)&&(i.schedule(d),e())}u=!1}};return i}((function(){return o=!0})),e}),{}),d=c.reduce((function(e,n){var t=a[n];return e[n]=function(e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!1),o||m(),t.schedule(e,n,r)},e}),{}),s=c.reduce((function(e,n){return e[n]=a[n].cancel,e}),{}),l=function(e){return a[e].process(f)},p=function(e){o=!1,f.delta=u?n:Math.max(Math.min(e-f.timestamp,40),1),f.timestamp=e,i=!0,c.forEach(l),i=!1,o&&(u=!1,r(p))},m=function(){o=!0,u=!0,i||r(p)};e.cancelSync=s,e.default=d,e.getFrameData=function(){return f},Object.defineProperty(e,"__esModule",{value:!0})}));
