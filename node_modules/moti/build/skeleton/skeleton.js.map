{"version":3,"file":"skeleton.js","sourceRoot":"","sources":["../../src/skeleton/skeleton.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport { View as MotiView } from '@motify/components'\nimport { View, StyleSheet } from 'react-native'\n\nimport { LinearGradient } from 'expo-linear-gradient'\nimport { AnimatePresence, MotiTransitionProp } from '@motify/core'\n\ntype Props = {\n  /**\n   * Optional height of the container of the skeleton. If set, it will give a fixed height to the container.\n   *\n   * If not set, the container will stretch to the children.\n   */\n  boxHeight?: number | string\n  /**\n   * Optional height of the skeleton. Defauls to a `minHeight` of `32`\n   */\n  height?: number | string\n  children?: React.ReactChild\n  /**\n   * `boolean` specifying whether the skeleton should be visible. By default, it shows if there are no children. This way, you can conditionally display children, and automatically hide the skeleton when they exist.\n   *\n   * ```tsx\n   * // skeleton will hide when data exists\n   * <Skeleton>\n   *   {data ? <Data /> : null}\n   * </Skeleton>\n   * ```\n   *\n   * // skeleton will always show\n   * <Skeleton show>\n   *   {data ? <Data /> : null}\n   * </Skeleton>\n   *\n   * // skeleton will always hide\n   * <Skeleton show={false}>\n   *   {data ? <Data /> : null}\n   * </Skeleton>\n   */\n  show?: boolean\n  /**\n   * Width of the skeleton. Defaults to `32` as the `minWidth`. Sets the container's `minWidth` to this value if defined, falling back to 32.\n   */\n  width?: string | number\n  /**\n   * Border radius. Can be `square`, `round`, or a number. `round` makes it a circle. Defaults to `8`.\n   */\n  radius?: number | 'square' | 'round'\n  /**\n   * Background of the box that contains the skeleton. Should match the main `colors` prop color.\n   *\n   * Default: `'rgb(51, 51, 51, 50)'`\n   */\n  backgroundColor?: string\n  /**\n   * Gradient colors. Defaults to grayish black.\n   */\n  colors?: string[]\n  /**\n   * Default: `6`. Similar to `600%` for CSS `background-size`. Determines how much the gradient stretches.\n   */\n  backgroundSize?: number\n  /**\n   * `light` or `dark`. Default: `dark`.\n   */\n  colorMode?: keyof typeof baseColors\n  disableExitAnimation?: boolean\n  transition?: MotiTransitionProp\n}\n\nconst DEFAULT_SIZE = 32\n\nconst baseColors = {\n  dark: { primary: 'rgb(17, 17, 17)', secondary: 'rgb(51, 51, 51)' },\n  light: {\n    primary: 'rgb(250, 250, 250)',\n    secondary: 'rgb(205, 205, 205)',\n  },\n} as const\n\nconst makeColors = (mode: keyof typeof baseColors) => [\n  baseColors[mode].primary,\n  baseColors[mode].secondary,\n  baseColors[mode].secondary,\n  baseColors[mode].primary,\n  baseColors[mode].secondary,\n  baseColors[mode].primary,\n]\n\nlet defaultDarkColors = makeColors('dark')\n\nlet defaultLightColors = makeColors('light')\n\nfor (let i = 0; i++; i < 3) {\n  defaultDarkColors = [...defaultDarkColors, ...defaultDarkColors]\n  defaultLightColors = [...defaultLightColors, ...defaultLightColors]\n}\n\nexport default function Skeleton(props: Props) {\n  const {\n    radius = 8,\n    children,\n    show = !children,\n    width,\n    height = children ? undefined : DEFAULT_SIZE,\n    boxHeight,\n    colorMode = 'dark',\n    colors = colorMode === 'dark' ? defaultDarkColors : defaultLightColors,\n    backgroundColor = colors[0] ??\n      colors[1] ??\n      baseColors[colorMode]?.secondary,\n    backgroundSize = 6,\n    disableExitAnimation,\n    transition,\n  } = props\n\n  const [measuredWidth, setMeasuredWidth] = useState(0)\n\n  const getBorderRadius = () => {\n    if (radius === 'square') {\n      return 0\n    }\n    if (radius === 'round') {\n      return 99999\n    }\n    return radius\n  }\n\n  const borderRadius = getBorderRadius()\n\n  const getOuterHeight = () => {\n    if (boxHeight != null) return boxHeight\n    if (show && !children) {\n      return height\n    }\n    return undefined\n  }\n\n  const outerHeight = getOuterHeight()\n\n  return (\n    <View\n      style={{\n        height: outerHeight,\n        minHeight: height,\n        minWidth: width ?? (children ? undefined : DEFAULT_SIZE),\n      }}\n    >\n      {children}\n      <AnimatePresence>\n        {show && (\n          <MotiView\n            style={{\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              borderRadius,\n              width: width ?? (children ? '100%' : DEFAULT_SIZE),\n              height: height ?? '100%',\n              overflow: 'hidden',\n            }}\n            animate={{\n              backgroundColor,\n              opacity: 1,\n            }}\n            transition={{\n              type: 'timing',\n            }}\n            exit={\n              !disableExitAnimation && {\n                opacity: 0,\n              }\n            }\n            onLayout={({ nativeEvent }) => {\n              if (measuredWidth === nativeEvent.layout.width) return\n\n              setMeasuredWidth(nativeEvent.layout.width)\n            }}\n            pointerEvents=\"none\"\n          >\n            <AnimatedGradient\n              // force a key change to make the loop animation re-mount\n              key={`${JSON.stringify(colors)}-${measuredWidth}-${JSON.stringify(\n                transition || null\n              )}`}\n              colors={colors}\n              backgroundSize={backgroundSize}\n              measuredWidth={measuredWidth}\n              transition={transition}\n            />\n          </MotiView>\n        )}\n      </AnimatePresence>\n    </View>\n  )\n}\n\nconst AnimatedGradient = React.memo(\n  function AnimatedGradient({\n    measuredWidth,\n    colors,\n    backgroundSize,\n    transition = {},\n  }: {\n    measuredWidth: number\n    colors: string[]\n    backgroundSize: number,\n    transition?: MotiTransitionProp\n  }) {\n\n    return (\n      <MotiView\n        style={StyleSheet.absoluteFillObject}\n        from={{ opacity: 0 }}\n        transition={{\n          type: 'timing',\n          duration: 200,\n        }}\n        animate={\n          measuredWidth\n            ? {\n                opacity: 1,\n              }\n            : undefined\n        }\n      >\n        <MotiView\n          style={[\n            StyleSheet.absoluteFillObject,\n            {\n              width: measuredWidth * backgroundSize,\n            },\n          ]}\n          from={{\n            translateX: 0,\n          }}\n          animate={\n            measuredWidth\n              ? {\n                  translateX: -measuredWidth * (backgroundSize - 1),\n                }\n              : undefined\n          }\n          transition={{\n            loop: true,\n            delay: 200,\n            type: 'timing',\n            duration: 3000,\n            ...(transition as any),\n          }}\n        >\n          <LinearGradient\n            colors={colors}\n            start={[0.1, 1]}\n            end={[1, 1]}\n            style={StyleSheet.absoluteFillObject}\n          />\n        </MotiView>\n      </MotiView>\n    )\n  },\n  function propsAreEqual(prev, next) {\n    return JSON.stringify(prev) === JSON.stringify(next)\n  }\n)\n"]}